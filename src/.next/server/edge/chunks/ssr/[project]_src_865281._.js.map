{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 5, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/src/services/auth/index.ts"],"sourcesContent":["\"use server\"\r\nimport axiosInstance from \"@/hooks/axiosInstance\";\r\nimport { jwtDecode } from \"jwt-decode\";\r\nimport { cookies } from \"next/headers\";\r\nimport { FieldValues } from \"react-hook-form\";\r\n\r\nexport const handleAuthMutation = async (url: string, payload: FieldValues) => {\r\n  try {\r\n    const { data } = await axiosInstance.post(url, payload);\r\n    if (data?.success) {\r\n      cookies().set(\"accessToken\", data?.data?.accessToken);\r\n      cookies().set(\"refreshToken\", data?.data?.refreshToken);\r\n    }\r\n\r\n    return data\r\n  } catch (error: any) {\r\n    throw new Error(error?.response?.data?.message || \"Something went wrong\");\r\n  }\r\n}\r\n\r\nexport const getCurrentUser = async () => {\r\n  const accessToken = cookies().get(\"accessToken\")?.value;\r\n  let decodedUser = null;\r\n  if (accessToken) {\r\n    decodedUser = await jwtDecode(accessToken);\r\n    return {\r\n      _id: decodedUser._id,\r\n      name: decodedUser.name,\r\n      email: decodedUser.email,\r\n      role: decodedUser.role,\r\n    };\r\n  }\r\n  return decodedUser;\r\n};\r\n\r\n\r\nexport const logOut = () => {\r\n  cookies().delete(\"accessToken\")\r\n  cookies().delete(\"refreshToken\")\r\n}"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA;;;;AAMO,MAAM,qBAAqB,OAAO,KAAa;IACpD,IAAI;QACF,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,cAAc,IAAI,CAAC,KAAK;QAC/C,IAAI,MAAM,SAAS;YACjB,CAAA,GAAA,sKAAA,CAAA,UAAO,AAAD,IAAI,GAAG,CAAC,eAAe,MAAM,MAAM;YACzC,CAAA,GAAA,sKAAA,CAAA,UAAO,AAAD,IAAI,GAAG,CAAC,gBAAgB,MAAM,MAAM;QAC5C;QAEA,OAAO;IACT,EAAE,OAAO,OAAY;QACnB,MAAM,IAAI,MAAM,OAAO,UAAU,MAAM,WAAW;IACpD;AACF;AAEO,MAAM,iBAAiB;IAC5B,MAAM,cAAc,CAAA,GAAA,sKAAA,CAAA,UAAO,AAAD,IAAI,GAAG,CAAC,gBAAgB;IAClD,IAAI,cAAc;IAClB,IAAI,aAAa;QACf,cAAc,MAAM,CAAA,GAAA,sJAAA,CAAA,YAAS,AAAD,EAAE;QAC9B,OAAO;YACL,KAAK,YAAY,GAAG;YACpB,MAAM,YAAY,IAAI;YACtB,OAAO,YAAY,KAAK;YACxB,MAAM,YAAY,IAAI;QACxB;IACF;IACA,OAAO;AACT;AAGO,MAAM,SAAS;IACpB,CAAA,GAAA,sKAAA,CAAA,UAAO,AAAD,IAAI,MAAM,CAAC;IACjB,CAAA,GAAA,sKAAA,CAAA,UAAO,AAAD,IAAI,MAAM,CAAC;AACnB"}},
    {"offset": {"line": 53, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/src/middleware.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\r\nimport type { NextRequest } from \"next/server\";\r\nimport { getCurrentUser } from \"./services/auth\";\r\nconst authRoutes = [\"/auth/login\", \"/auth/register\", \"/auth/forget-password\", \"/auth/reset-password\",];\r\n\r\nconst roleBasedRoutes = {\r\n  user: [/^\\/author/],\r\n  admin: [/^\\/admin/],\r\n};\r\n\r\ntype TRole = keyof typeof roleBasedRoutes;\r\n\r\n// This function can be marked `async` if using `await` inside\r\nexport async function middleware(request: NextRequest) {\r\n  const user = await getCurrentUser();\r\n\r\n  const { pathname } = request.nextUrl;\r\n\r\n  if (!user) {\r\n    if (authRoutes.includes(pathname)) {\r\n      return NextResponse.next();\r\n    } else {\r\n      return NextResponse.redirect(\r\n        new URL(`/auth/login?redirect=${pathname}`, request.url)\r\n      );\r\n    }\r\n  }\r\n\r\n  if ((user?.role as TRole) && roleBasedRoutes[user?.role as TRole]) {\r\n    if (pathname === \"/profile\") {\r\n      return NextResponse.next();\r\n    }\r\n    const routes = roleBasedRoutes[user?.role as TRole];\r\n    if (routes.some((route) => pathname.match(route))) {\r\n      return NextResponse.next();\r\n    }\r\n  }\r\n\r\n  return NextResponse.redirect(new URL(\"/\", request.url));\r\n}\r\n\r\nexport const config = {\r\n  matcher: [\"/author/:path*\", \"/admin/:path*\", \"/auth/:path*\", \"/profile\"],\r\n};\r\n"],"names":[],"mappings":";;;;;;;;;;AAGA,MAAM,aAAa;IAAC;IAAe;IAAkB;IAAyB;CAAwB;AAEtG,MAAM,kBAAkB;IACtB,MAAM;QAAC;KAAY;IACnB,OAAO;QAAC;KAAW;AACrB;AAKO,eAAe,WAAW,OAAoB;IACnD,MAAM,OAAO,MAAM,CAAA,GAAA,gIAAA,CAAA,iBAAc,AAAD;IAEhC,MAAM,EAAE,QAAQ,EAAE,GAAG,QAAQ,OAAO;IAEpC,IAAI,CAAC,MAAM;QACT,IAAI,WAAW,QAAQ,CAAC,WAAW;YACjC,OAAO,qLAAA,CAAA,eAAY,CAAC,IAAI;QAC1B,OAAO;YACL,OAAO,qLAAA,CAAA,eAAY,CAAC,QAAQ,CAC1B,IAAI,IAAI,CAAC,qBAAqB,EAAE,SAAS,CAAC,EAAE,QAAQ,GAAG;QAE3D;IACF;IAEA,IAAI,AAAC,MAAM,QAAkB,eAAe,CAAC,MAAM,KAAc,EAAE;QACjE,IAAI,aAAa,YAAY;YAC3B,OAAO,qLAAA,CAAA,eAAY,CAAC,IAAI;QAC1B;QACA,MAAM,SAAS,eAAe,CAAC,MAAM,KAAc;QACnD,IAAI,OAAO,IAAI,CAAC,CAAC,QAAU,SAAS,KAAK,CAAC,SAAS;YACjD,OAAO,qLAAA,CAAA,eAAY,CAAC,IAAI;QAC1B;IACF;IAEA,OAAO,qLAAA,CAAA,eAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,KAAK,QAAQ,GAAG;AACvD;AAEO,MAAM,SAAS;IACpB,SAAS;QAAC;QAAkB;QAAiB;QAAgB;KAAW;AAC1E"}},
    {"offset": {"line": 111, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}